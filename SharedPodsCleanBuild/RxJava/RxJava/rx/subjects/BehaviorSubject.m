//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/kgalligan/devel/xp/sourcejava/RxJava/src/main/java/rx/subjects/BehaviorSubject.java
//

#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "J2ObjC_source.h"
#include "java/lang/RuntimeException.h"
#include "java/util/ArrayList.h"
#include "java/util/List.h"
#include "rx/Observable.h"
#include "rx/exceptions/CompositeException.h"
#include "rx/exceptions/Exceptions.h"
#include "rx/functions/Action1.h"
#include "rx/internal/operators/NotificationLite.h"
#include "rx/subjects/BehaviorSubject.h"
#include "rx/subjects/Subject.h"
#include "rx/subjects/SubjectSubscriptionManager.h"

@interface RxSubjectsBehaviorSubject () {
 @public
  RxSubjectsSubjectSubscriptionManager *state_;
  RxInternalOperatorsNotificationLite *nl_;
}

+ (RxSubjectsBehaviorSubject *)createWithId:(id)defaultValue
                                withBoolean:(jboolean)hasDefault;

@end

J2OBJC_FIELD_SETTER(RxSubjectsBehaviorSubject, state_, RxSubjectsSubjectSubscriptionManager *)
J2OBJC_FIELD_SETTER(RxSubjectsBehaviorSubject, nl_, RxInternalOperatorsNotificationLite *)

__attribute__((unused)) static RxSubjectsBehaviorSubject *RxSubjectsBehaviorSubject_createWithId_withBoolean_(id defaultValue, jboolean hasDefault);

@interface RxSubjectsBehaviorSubject_$1 : NSObject < RxFunctionsAction1 > {
 @public
  RxSubjectsSubjectSubscriptionManager *val$state_;
}

- (void)callWithId:(RxSubjectsSubjectSubscriptionManager_SubjectObserver *)o;

- (instancetype)initWithRxSubjectsSubjectSubscriptionManager:(RxSubjectsSubjectSubscriptionManager *)capture$0;

@end

J2OBJC_EMPTY_STATIC_INIT(RxSubjectsBehaviorSubject_$1)

J2OBJC_FIELD_SETTER(RxSubjectsBehaviorSubject_$1, val$state_, RxSubjectsSubjectSubscriptionManager *)

__attribute__((unused)) static void RxSubjectsBehaviorSubject_$1_initWithRxSubjectsSubjectSubscriptionManager_(RxSubjectsBehaviorSubject_$1 *self, RxSubjectsSubjectSubscriptionManager *capture$0);

__attribute__((unused)) static RxSubjectsBehaviorSubject_$1 *new_RxSubjectsBehaviorSubject_$1_initWithRxSubjectsSubjectSubscriptionManager_(RxSubjectsSubjectSubscriptionManager *capture$0) NS_RETURNS_RETAINED;

__attribute__((unused)) static RxSubjectsBehaviorSubject_$1 *create_RxSubjectsBehaviorSubject_$1_initWithRxSubjectsSubjectSubscriptionManager_(RxSubjectsSubjectSubscriptionManager *capture$0);

J2OBJC_TYPE_LITERAL_HEADER(RxSubjectsBehaviorSubject_$1)

@implementation RxSubjectsBehaviorSubject

+ (RxSubjectsBehaviorSubject *)create {
  return RxSubjectsBehaviorSubject_create();
}

+ (RxSubjectsBehaviorSubject *)createWithId:(id)defaultValue {
  return RxSubjectsBehaviorSubject_createWithId_(defaultValue);
}

+ (RxSubjectsBehaviorSubject *)createWithId:(id)defaultValue
                                withBoolean:(jboolean)hasDefault {
  return RxSubjectsBehaviorSubject_createWithId_withBoolean_(defaultValue, hasDefault);
}

- (instancetype)initWithRxObservable_OnSubscribe:(id<RxObservable_OnSubscribe>)onSubscribe
        withRxSubjectsSubjectSubscriptionManager:(RxSubjectsSubjectSubscriptionManager *)state {
  RxSubjectsBehaviorSubject_initWithRxObservable_OnSubscribe_withRxSubjectsSubjectSubscriptionManager_(self, onSubscribe, state);
  return self;
}

- (void)onCompleted {
  id last = [((RxSubjectsSubjectSubscriptionManager *) nil_chk(state_)) get];
  if (last == nil || state_->active_) {
    id n = [((RxInternalOperatorsNotificationLite *) nil_chk(nl_)) completed];
    {
      IOSObjectArray *a__ = [state_ terminateWithId:n];
      RxSubjectsSubjectSubscriptionManager_SubjectObserver * const *b__ = ((IOSObjectArray *) nil_chk(a__))->buffer_;
      RxSubjectsSubjectSubscriptionManager_SubjectObserver * const *e__ = b__ + a__->size_;
      while (b__ < e__) {
        RxSubjectsSubjectSubscriptionManager_SubjectObserver *bo = *b__++;
        [((RxSubjectsSubjectSubscriptionManager_SubjectObserver *) nil_chk(bo)) emitNextWithId:n withRxInternalOperatorsNotificationLite:state_->nl_];
      }
    }
  }
}

- (void)onErrorWithNSException:(NSException *)e {
  id last = [((RxSubjectsSubjectSubscriptionManager *) nil_chk(state_)) get];
  if (last == nil || state_->active_) {
    id n = [((RxInternalOperatorsNotificationLite *) nil_chk(nl_)) errorWithNSException:e];
    id<JavaUtilList> errors = nil;
    {
      IOSObjectArray *a__ = [state_ terminateWithId:n];
      RxSubjectsSubjectSubscriptionManager_SubjectObserver * const *b__ = ((IOSObjectArray *) nil_chk(a__))->buffer_;
      RxSubjectsSubjectSubscriptionManager_SubjectObserver * const *e__ = b__ + a__->size_;
      while (b__ < e__) {
        RxSubjectsSubjectSubscriptionManager_SubjectObserver *bo = *b__++;
        @try {
          [((RxSubjectsSubjectSubscriptionManager_SubjectObserver *) nil_chk(bo)) emitNextWithId:n withRxInternalOperatorsNotificationLite:state_->nl_];
        }
        @catch (NSException *e2) {
          if (errors == nil) {
            errors = new_JavaUtilArrayList_init();
          }
          [((id<JavaUtilList>) nil_chk(errors)) addWithId:e2];
        }
      }
    }
    if (errors != nil) {
      if ([errors size] == 1) {
        (void) RxExceptionsExceptions_propagateWithNSException_([errors getWithInt:0]);
      }
      else {
        @throw new_RxExceptionsCompositeException_initWithNSString_withJavaUtilCollection_(@"Errors while emitting AsyncSubject.onError", errors);
      }
    }
  }
}

- (void)onNextWithId:(id)v {
  id last = [((RxSubjectsSubjectSubscriptionManager *) nil_chk(state_)) get];
  if (last == nil || state_->active_) {
    id n = [((RxInternalOperatorsNotificationLite *) nil_chk(nl_)) nextWithId:v];
    {
      IOSObjectArray *a__ = [state_ nextWithId:n];
      RxSubjectsSubjectSubscriptionManager_SubjectObserver * const *b__ = ((IOSObjectArray *) nil_chk(a__))->buffer_;
      RxSubjectsSubjectSubscriptionManager_SubjectObserver * const *e__ = b__ + a__->size_;
      while (b__ < e__) {
        RxSubjectsSubjectSubscriptionManager_SubjectObserver *bo = *b__++;
        [((RxSubjectsSubjectSubscriptionManager_SubjectObserver *) nil_chk(bo)) emitNextWithId:n withRxInternalOperatorsNotificationLite:state_->nl_];
      }
    }
  }
}

- (jint)subscriberCount {
  return ((IOSObjectArray *) nil_chk([((RxSubjectsSubjectSubscriptionManager *) nil_chk(state_)) observers]))->size_;
}

- (jboolean)hasObservers {
  return ((IOSObjectArray *) nil_chk([((RxSubjectsSubjectSubscriptionManager *) nil_chk(state_)) observers]))->size_ > 0;
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "create", NULL, "Lrx.subjects.BehaviorSubject;", 0x9, NULL, "<T:Ljava/lang/Object;>()Lrx/subjects/BehaviorSubject<TT;>;" },
    { "createWithId:", "create", "Lrx.subjects.BehaviorSubject;", 0x9, NULL, "<T:Ljava/lang/Object;>(TT;)Lrx/subjects/BehaviorSubject<TT;>;" },
    { "createWithId:withBoolean:", "create", "Lrx.subjects.BehaviorSubject;", 0xa, NULL, "<T:Ljava/lang/Object;>(TT;Z)Lrx/subjects/BehaviorSubject<TT;>;" },
    { "initWithRxObservable_OnSubscribe:withRxSubjectsSubjectSubscriptionManager:", "BehaviorSubject", NULL, 0x4, NULL, "(Lrx/Observable$OnSubscribe<TT;>;Lrx/subjects/SubjectSubscriptionManager<TT;>;)V" },
    { "onCompleted", NULL, "V", 0x1, NULL, NULL },
    { "onErrorWithNSException:", "onError", "V", 0x1, NULL, NULL },
    { "onNextWithId:", "onNext", "V", 0x1, NULL, "(TT;)V" },
    { "subscriberCount", NULL, "I", 0x0, NULL, NULL },
    { "hasObservers", NULL, "Z", 0x1, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "state_", NULL, 0x12, "Lrx.subjects.SubjectSubscriptionManager;", NULL, "Lrx/subjects/SubjectSubscriptionManager<TT;>;", .constantValue.asLong = 0 },
    { "nl_", NULL, 0x12, "Lrx.internal.operators.NotificationLite;", NULL, "Lrx/internal/operators/NotificationLite<TT;>;", .constantValue.asLong = 0 },
  };
  static const char *superclass_type_args[] = {"TT;", "TT;"};
  static const J2ObjcClassInfo _RxSubjectsBehaviorSubject = { 2, "BehaviorSubject", "rx.subjects", NULL, 0x11, 9, methods, 2, fields, 2, superclass_type_args, 0, NULL, NULL, "<T:Ljava/lang/Object;>Lrx/subjects/Subject<TT;TT;>;" };
  return &_RxSubjectsBehaviorSubject;
}

@end

RxSubjectsBehaviorSubject *RxSubjectsBehaviorSubject_create() {
  RxSubjectsBehaviorSubject_initialize();
  return RxSubjectsBehaviorSubject_createWithId_withBoolean_(nil, false);
}

RxSubjectsBehaviorSubject *RxSubjectsBehaviorSubject_createWithId_(id defaultValue) {
  RxSubjectsBehaviorSubject_initialize();
  return RxSubjectsBehaviorSubject_createWithId_withBoolean_(defaultValue, true);
}

RxSubjectsBehaviorSubject *RxSubjectsBehaviorSubject_createWithId_withBoolean_(id defaultValue, jboolean hasDefault) {
  RxSubjectsBehaviorSubject_initialize();
  RxSubjectsSubjectSubscriptionManager *state = new_RxSubjectsSubjectSubscriptionManager_init();
  if (hasDefault) {
    [state setWithId:[((RxInternalOperatorsNotificationLite *) nil_chk(RxInternalOperatorsNotificationLite_instance())) nextWithId:defaultValue]];
  }
  state->onAdded_ = new_RxSubjectsBehaviorSubject_$1_initWithRxSubjectsSubjectSubscriptionManager_(state);
  state->onTerminated_ = state->onAdded_;
  return new_RxSubjectsBehaviorSubject_initWithRxObservable_OnSubscribe_withRxSubjectsSubjectSubscriptionManager_(state, state);
}

void RxSubjectsBehaviorSubject_initWithRxObservable_OnSubscribe_withRxSubjectsSubjectSubscriptionManager_(RxSubjectsBehaviorSubject *self, id<RxObservable_OnSubscribe> onSubscribe, RxSubjectsSubjectSubscriptionManager *state) {
  RxSubjectsSubject_initWithRxObservable_OnSubscribe_(self, onSubscribe);
  self->nl_ = RxInternalOperatorsNotificationLite_instance();
  self->state_ = state;
}

RxSubjectsBehaviorSubject *new_RxSubjectsBehaviorSubject_initWithRxObservable_OnSubscribe_withRxSubjectsSubjectSubscriptionManager_(id<RxObservable_OnSubscribe> onSubscribe, RxSubjectsSubjectSubscriptionManager *state) {
  RxSubjectsBehaviorSubject *self = [RxSubjectsBehaviorSubject alloc];
  RxSubjectsBehaviorSubject_initWithRxObservable_OnSubscribe_withRxSubjectsSubjectSubscriptionManager_(self, onSubscribe, state);
  return self;
}

RxSubjectsBehaviorSubject *create_RxSubjectsBehaviorSubject_initWithRxObservable_OnSubscribe_withRxSubjectsSubjectSubscriptionManager_(id<RxObservable_OnSubscribe> onSubscribe, RxSubjectsSubjectSubscriptionManager *state) {
  return new_RxSubjectsBehaviorSubject_initWithRxObservable_OnSubscribe_withRxSubjectsSubjectSubscriptionManager_(onSubscribe, state);
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(RxSubjectsBehaviorSubject)

@implementation RxSubjectsBehaviorSubject_$1

- (void)callWithId:(RxSubjectsSubjectSubscriptionManager_SubjectObserver *)o {
  [((RxSubjectsSubjectSubscriptionManager_SubjectObserver *) nil_chk(o)) emitFirstWithId:[((RxSubjectsSubjectSubscriptionManager *) nil_chk(val$state_)) get] withRxInternalOperatorsNotificationLite:val$state_->nl_];
}

- (instancetype)initWithRxSubjectsSubjectSubscriptionManager:(RxSubjectsSubjectSubscriptionManager *)capture$0 {
  RxSubjectsBehaviorSubject_$1_initWithRxSubjectsSubjectSubscriptionManager_(self, capture$0);
  return self;
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "callWithId:", "call", "V", 0x1, NULL, "(Lrx/subjects/SubjectSubscriptionManager$SubjectObserver<TT;>;)V" },
    { "initWithRxSubjectsSubjectSubscriptionManager:", "", NULL, 0x0, NULL, "(Lrx/subjects/SubjectSubscriptionManager<TT;>;)V" },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "val$state_", NULL, 0x1012, "Lrx.subjects.SubjectSubscriptionManager;", NULL, "Lrx/subjects/SubjectSubscriptionManager<TT;>;", .constantValue.asLong = 0 },
  };
  static const J2ObjCEnclosingMethodInfo enclosing_method = { "RxSubjectsBehaviorSubject", "createWithId:withBoolean:" };
  static const J2ObjcClassInfo _RxSubjectsBehaviorSubject_$1 = { 2, "", "rx.subjects", "BehaviorSubject", 0x8008, 2, methods, 1, fields, 0, NULL, 0, NULL, &enclosing_method, "Ljava/lang/Object;Lrx/functions/Action1<Lrx/subjects/SubjectSubscriptionManager$SubjectObserver<TT;>;>;" };
  return &_RxSubjectsBehaviorSubject_$1;
}

@end

void RxSubjectsBehaviorSubject_$1_initWithRxSubjectsSubjectSubscriptionManager_(RxSubjectsBehaviorSubject_$1 *self, RxSubjectsSubjectSubscriptionManager *capture$0) {
  self->val$state_ = capture$0;
  NSObject_init(self);
}

RxSubjectsBehaviorSubject_$1 *new_RxSubjectsBehaviorSubject_$1_initWithRxSubjectsSubjectSubscriptionManager_(RxSubjectsSubjectSubscriptionManager *capture$0) {
  RxSubjectsBehaviorSubject_$1 *self = [RxSubjectsBehaviorSubject_$1 alloc];
  RxSubjectsBehaviorSubject_$1_initWithRxSubjectsSubjectSubscriptionManager_(self, capture$0);
  return self;
}

RxSubjectsBehaviorSubject_$1 *create_RxSubjectsBehaviorSubject_$1_initWithRxSubjectsSubjectSubscriptionManager_(RxSubjectsSubjectSubscriptionManager *capture$0) {
  return new_RxSubjectsBehaviorSubject_$1_initWithRxSubjectsSubjectSubscriptionManager_(capture$0);
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(RxSubjectsBehaviorSubject_$1)
