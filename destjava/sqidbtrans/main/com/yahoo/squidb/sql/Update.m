//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/kgalligan/devel/xp/squidb/squidb/src/com/yahoo/squidb/sql/Update.java
//

#include "IOSObjectArray.h"
#include "J2ObjC_source.h"
#include "com/yahoo/squidb/data/AbstractModel.h"
#include "com/yahoo/squidb/data/ValuesStorage.h"
#include "com/yahoo/squidb/sql/Criterion.h"
#include "com/yahoo/squidb/sql/Property.h"
#include "com/yahoo/squidb/sql/SqlBuilder.h"
#include "com/yahoo/squidb/sql/SqlTable.h"
#include "com/yahoo/squidb/sql/Table.h"
#include "com/yahoo/squidb/sql/TableStatement.h"
#include "com/yahoo/squidb/sql/Update.h"
#include "com/yahoo/squidb/sql/View.h"
#include "java/lang/IllegalArgumentException.h"
#include "java/lang/IllegalStateException.h"
#include "java/lang/StringBuilder.h"
#include "java/util/ArrayList.h"
#include "java/util/HashMap.h"
#include "java/util/List.h"
#include "java/util/Map.h"
#include "java/util/Set.h"

@interface ComYahooSquidbSqlUpdate () {
 @public
  ComYahooSquidbSqlSqlTable *table_;
  ComYahooSquidbSqlTableStatement_ConflictAlgorithm *conflictAlgorithm_;
  id<JavaUtilMap> valuesToUpdate_;
  id<JavaUtilList> criterions_;
}

- (void)assertValues;

- (void)visitConflictAlgorithmWithJavaLangStringBuilder:(JavaLangStringBuilder *)sql;

- (void)visitWhereWithComYahooSquidbSqlSqlBuilder:(ComYahooSquidbSqlSqlBuilder *)builder
                                      withBoolean:(jboolean)forSqlValidation;

@end

J2OBJC_FIELD_SETTER(ComYahooSquidbSqlUpdate, table_, ComYahooSquidbSqlSqlTable *)
J2OBJC_FIELD_SETTER(ComYahooSquidbSqlUpdate, conflictAlgorithm_, ComYahooSquidbSqlTableStatement_ConflictAlgorithm *)
J2OBJC_FIELD_SETTER(ComYahooSquidbSqlUpdate, valuesToUpdate_, id<JavaUtilMap>)
J2OBJC_FIELD_SETTER(ComYahooSquidbSqlUpdate, criterions_, id<JavaUtilList>)

__attribute__((unused)) static void ComYahooSquidbSqlUpdate_assertValues(ComYahooSquidbSqlUpdate *self);

__attribute__((unused)) static void ComYahooSquidbSqlUpdate_visitConflictAlgorithmWithJavaLangStringBuilder_(ComYahooSquidbSqlUpdate *self, JavaLangStringBuilder *sql);

__attribute__((unused)) static void ComYahooSquidbSqlUpdate_visitWhereWithComYahooSquidbSqlSqlBuilder_withBoolean_(ComYahooSquidbSqlUpdate *self, ComYahooSquidbSqlSqlBuilder *builder, jboolean forSqlValidation);

@implementation ComYahooSquidbSqlUpdate

- (instancetype)initWithComYahooSquidbSqlSqlTable:(ComYahooSquidbSqlSqlTable *)table {
  ComYahooSquidbSqlUpdate_initWithComYahooSquidbSqlSqlTable_(self, table);
  return self;
}

+ (ComYahooSquidbSqlUpdate *)tableWithComYahooSquidbSqlTable:(ComYahooSquidbSqlTable *)table {
  return ComYahooSquidbSqlUpdate_tableWithComYahooSquidbSqlTable_(table);
}

+ (ComYahooSquidbSqlUpdate *)tableWithComYahooSquidbSqlView:(ComYahooSquidbSqlView *)view {
  return ComYahooSquidbSqlUpdate_tableWithComYahooSquidbSqlView_(view);
}

- (ComYahooSquidbSqlSqlTable *)getTable {
  return table_;
}

- (ComYahooSquidbSqlUpdate *)onConflictWithComYahooSquidbSqlTableStatement_ConflictAlgorithm:(ComYahooSquidbSqlTableStatement_ConflictAlgorithm *)conflictAlgorithm {
  self->conflictAlgorithm_ = conflictAlgorithm;
  [self invalidateCompileCache];
  return self;
}

- (ComYahooSquidbSqlUpdate *)whereWithComYahooSquidbSqlCriterion:(ComYahooSquidbSqlCriterion *)criterion {
  if (criterion != nil) {
    [((id<JavaUtilList>) nil_chk(self->criterions_)) addWithId:criterion];
    [self invalidateCompileCache];
  }
  return self;
}

- (ComYahooSquidbSqlUpdate *)setWithComYahooSquidbSqlProperty:(ComYahooSquidbSqlProperty *)column
                                                       withId:(id)value {
  if (column == nil) {
    @throw new_JavaLangIllegalArgumentException_initWithNSString_(@"column must not be null");
  }
  (void) [((id<JavaUtilMap>) nil_chk(valuesToUpdate_)) putWithId:[((ComYahooSquidbSqlProperty *) nil_chk(column)) getExpression] withId:value];
  [self invalidateCompileCache];
  return self;
}

- (ComYahooSquidbSqlUpdate *)setWithComYahooSquidbSqlPropertyArray:(IOSObjectArray *)columns
                                                 withNSObjectArray:(IOSObjectArray *)values {
  if (((IOSObjectArray *) nil_chk(columns))->size_ != ((IOSObjectArray *) nil_chk(values))->size_) {
    @throw new_JavaLangIllegalArgumentException_initWithNSString_(@"You must provide the same number of columns and values");
  }
  for (jint i = 0; i < columns->size_; i++) {
    (void) [self setWithComYahooSquidbSqlProperty:IOSObjectArray_Get(columns, i) withId:IOSObjectArray_Get(values, i)];
  }
  [self invalidateCompileCache];
  return self;
}

- (ComYahooSquidbSqlUpdate *)setWithJavaUtilList:(id<JavaUtilList>)columns
                                withJavaUtilList:(id<JavaUtilList>)values {
  jint size = [((id<JavaUtilList>) nil_chk(columns)) size];
  if (size != [((id<JavaUtilList>) nil_chk(values)) size]) {
    @throw new_JavaLangIllegalArgumentException_initWithNSString_(@"You must provide the same number of columns and values");
  }
  for (jint i = 0; i < size; i++) {
    (void) [self setWithComYahooSquidbSqlProperty:[columns getWithInt:i] withId:[values getWithInt:i]];
  }
  [self invalidateCompileCache];
  return self;
}

- (ComYahooSquidbSqlUpdate *)fromTemplateWithComYahooSquidbDataAbstractModel:(ComYahooSquidbDataAbstractModel *)template_ {
  if (![((ComYahooSquidbDataAbstractModel *) nil_chk(template_)) isModified]) {
    @throw new_JavaLangIllegalArgumentException_initWithNSString_(@"Template has no values set to use for update");
  }
  ComYahooSquidbDataValuesStorage *setValues = [template_ getSetValues];
  for (id<JavaUtilMap_Entry> __strong entry_ in nil_chk([((ComYahooSquidbDataValuesStorage *) nil_chk(setValues)) valueSet])) {
    (void) [((id<JavaUtilMap>) nil_chk(valuesToUpdate_)) putWithId:[((id<JavaUtilMap_Entry>) nil_chk(entry_)) getKey] withId:[entry_ getValue]];
  }
  [self invalidateCompileCache];
  return self;
}

- (void)appendToSqlBuilderWithComYahooSquidbSqlSqlBuilder:(ComYahooSquidbSqlSqlBuilder *)builder
                                              withBoolean:(jboolean)forSqlValidation {
  ComYahooSquidbSqlUpdate_assertValues(self);
  (void) [((JavaLangStringBuilder *) nil_chk(((ComYahooSquidbSqlSqlBuilder *) nil_chk(builder))->sql_)) appendWithNSString:@"UPDATE "];
  ComYahooSquidbSqlUpdate_visitConflictAlgorithmWithJavaLangStringBuilder_(self, builder->sql_);
  (void) [((JavaLangStringBuilder *) nil_chk([builder->sql_ appendWithNSString:[((ComYahooSquidbSqlSqlTable *) nil_chk(table_)) getExpression]])) appendWithNSString:@" SET "];
  [self visitValuesWithComYahooSquidbSqlSqlBuilder:builder withBoolean:forSqlValidation];
  ComYahooSquidbSqlUpdate_visitWhereWithComYahooSquidbSqlSqlBuilder_withBoolean_(self, builder, forSqlValidation);
}

- (void)assertValues {
  ComYahooSquidbSqlUpdate_assertValues(self);
}

- (void)visitConflictAlgorithmWithJavaLangStringBuilder:(JavaLangStringBuilder *)sql {
  ComYahooSquidbSqlUpdate_visitConflictAlgorithmWithJavaLangStringBuilder_(self, sql);
}

- (void)visitValuesWithComYahooSquidbSqlSqlBuilder:(ComYahooSquidbSqlSqlBuilder *)builder
                                       withBoolean:(jboolean)forSqlValidation {
  jboolean appendComma = false;
  for (NSString * __strong column in nil_chk([((id<JavaUtilMap>) nil_chk(valuesToUpdate_)) keySet])) {
    if (appendComma) {
      (void) [((JavaLangStringBuilder *) nil_chk(((ComYahooSquidbSqlSqlBuilder *) nil_chk(builder))->sql_)) appendWithNSString:@","];
    }
    appendComma = true;
    (void) [((JavaLangStringBuilder *) nil_chk([((JavaLangStringBuilder *) nil_chk(((ComYahooSquidbSqlSqlBuilder *) nil_chk(builder))->sql_)) appendWithNSString:column])) appendWithNSString:@" = "];
    id value = [valuesToUpdate_ getWithId:column];
    [builder addValueToSqlWithId:value withBoolean:forSqlValidation];
  }
}

- (void)visitWhereWithComYahooSquidbSqlSqlBuilder:(ComYahooSquidbSqlSqlBuilder *)builder
                                      withBoolean:(jboolean)forSqlValidation {
  ComYahooSquidbSqlUpdate_visitWhereWithComYahooSquidbSqlSqlBuilder_withBoolean_(self, builder, forSqlValidation);
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithComYahooSquidbSqlSqlTable:", "Update", NULL, 0x4, NULL, "(Lcom/yahoo/squidb/sql/SqlTable<*>;)V" },
    { "tableWithComYahooSquidbSqlTable:", "table", "Lcom.yahoo.squidb.sql.Update;", 0x9, NULL, NULL },
    { "tableWithComYahooSquidbSqlView:", "table", "Lcom.yahoo.squidb.sql.Update;", 0x9, NULL, NULL },
    { "getTable", NULL, "Lcom.yahoo.squidb.sql.SqlTable;", 0x1, NULL, "()Lcom/yahoo/squidb/sql/SqlTable<*>;" },
    { "onConflictWithComYahooSquidbSqlTableStatement_ConflictAlgorithm:", "onConflict", "Lcom.yahoo.squidb.sql.Update;", 0x1, NULL, NULL },
    { "whereWithComYahooSquidbSqlCriterion:", "where", "Lcom.yahoo.squidb.sql.Update;", 0x1, NULL, NULL },
    { "setWithComYahooSquidbSqlProperty:withId:", "set", "Lcom.yahoo.squidb.sql.Update;", 0x1, NULL, "(Lcom/yahoo/squidb/sql/Property<*>;Ljava/lang/Object;)Lcom/yahoo/squidb/sql/Update;" },
    { "setWithComYahooSquidbSqlPropertyArray:withNSObjectArray:", "set", "Lcom.yahoo.squidb.sql.Update;", 0x1, NULL, NULL },
    { "setWithJavaUtilList:withJavaUtilList:", "set", "Lcom.yahoo.squidb.sql.Update;", 0x1, NULL, "(Ljava/util/List<Lcom/yahoo/squidb/sql/Property<*>;>;Ljava/util/List<Ljava/lang/Object;>;)Lcom/yahoo/squidb/sql/Update;" },
    { "fromTemplateWithComYahooSquidbDataAbstractModel:", "fromTemplate", "Lcom.yahoo.squidb.sql.Update;", 0x1, NULL, NULL },
    { "appendToSqlBuilderWithComYahooSquidbSqlSqlBuilder:withBoolean:", "appendToSqlBuilder", "V", 0x0, NULL, NULL },
    { "assertValues", NULL, "V", 0x2, NULL, NULL },
    { "visitConflictAlgorithmWithJavaLangStringBuilder:", "visitConflictAlgorithm", "V", 0x2, NULL, NULL },
    { "visitValuesWithComYahooSquidbSqlSqlBuilder:withBoolean:", "visitValues", "V", 0x4, NULL, NULL },
    { "visitWhereWithComYahooSquidbSqlSqlBuilder:withBoolean:", "visitWhere", "V", 0x2, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "table_", NULL, 0x12, "Lcom.yahoo.squidb.sql.SqlTable;", NULL, "Lcom/yahoo/squidb/sql/SqlTable<*>;", .constantValue.asLong = 0 },
    { "conflictAlgorithm_", NULL, 0x2, "Lcom.yahoo.squidb.sql.TableStatement$ConflictAlgorithm;", NULL, NULL, .constantValue.asLong = 0 },
    { "valuesToUpdate_", NULL, 0x12, "Ljava.util.Map;", NULL, "Ljava/util/Map<Ljava/lang/String;Ljava/lang/Object;>;", .constantValue.asLong = 0 },
    { "criterions_", NULL, 0x12, "Ljava.util.List;", NULL, "Ljava/util/List<Lcom/yahoo/squidb/sql/Criterion;>;", .constantValue.asLong = 0 },
  };
  static const J2ObjcClassInfo _ComYahooSquidbSqlUpdate = { 2, "Update", "com.yahoo.squidb.sql", NULL, 0x1, 15, methods, 4, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_ComYahooSquidbSqlUpdate;
}

@end

void ComYahooSquidbSqlUpdate_initWithComYahooSquidbSqlSqlTable_(ComYahooSquidbSqlUpdate *self, ComYahooSquidbSqlSqlTable *table) {
  ComYahooSquidbSqlTableStatement_init(self);
  self->conflictAlgorithm_ = JreLoadEnum(ComYahooSquidbSqlTableStatement_ConflictAlgorithm, NONE);
  self->valuesToUpdate_ = new_JavaUtilHashMap_init();
  self->criterions_ = new_JavaUtilArrayList_init();
  self->table_ = table;
}

ComYahooSquidbSqlUpdate *new_ComYahooSquidbSqlUpdate_initWithComYahooSquidbSqlSqlTable_(ComYahooSquidbSqlSqlTable *table) {
  ComYahooSquidbSqlUpdate *self = [ComYahooSquidbSqlUpdate alloc];
  ComYahooSquidbSqlUpdate_initWithComYahooSquidbSqlSqlTable_(self, table);
  return self;
}

ComYahooSquidbSqlUpdate *create_ComYahooSquidbSqlUpdate_initWithComYahooSquidbSqlSqlTable_(ComYahooSquidbSqlSqlTable *table) {
  return new_ComYahooSquidbSqlUpdate_initWithComYahooSquidbSqlSqlTable_(table);
}

ComYahooSquidbSqlUpdate *ComYahooSquidbSqlUpdate_tableWithComYahooSquidbSqlTable_(ComYahooSquidbSqlTable *table) {
  ComYahooSquidbSqlUpdate_initialize();
  return new_ComYahooSquidbSqlUpdate_initWithComYahooSquidbSqlSqlTable_(table);
}

ComYahooSquidbSqlUpdate *ComYahooSquidbSqlUpdate_tableWithComYahooSquidbSqlView_(ComYahooSquidbSqlView *view) {
  ComYahooSquidbSqlUpdate_initialize();
  return new_ComYahooSquidbSqlUpdate_initWithComYahooSquidbSqlSqlTable_(view);
}

void ComYahooSquidbSqlUpdate_assertValues(ComYahooSquidbSqlUpdate *self) {
  if ([((id<JavaUtilMap>) nil_chk(self->valuesToUpdate_)) isEmpty]) {
    @throw new_JavaLangIllegalStateException_initWithNSString_(@"No columns specified for update");
  }
}

void ComYahooSquidbSqlUpdate_visitConflictAlgorithmWithJavaLangStringBuilder_(ComYahooSquidbSqlUpdate *self, JavaLangStringBuilder *sql) {
  if (JreLoadEnum(ComYahooSquidbSqlTableStatement_ConflictAlgorithm, NONE) != self->conflictAlgorithm_) {
    (void) [((JavaLangStringBuilder *) nil_chk([((JavaLangStringBuilder *) nil_chk([((JavaLangStringBuilder *) nil_chk(sql)) appendWithNSString:@"OR "])) appendWithId:self->conflictAlgorithm_])) appendWithNSString:@" "];
  }
}

void ComYahooSquidbSqlUpdate_visitWhereWithComYahooSquidbSqlSqlBuilder_withBoolean_(ComYahooSquidbSqlUpdate *self, ComYahooSquidbSqlSqlBuilder *builder, jboolean forSqlValidation) {
  if ([((id<JavaUtilList>) nil_chk(self->criterions_)) isEmpty]) {
    return;
  }
  (void) [((JavaLangStringBuilder *) nil_chk(((ComYahooSquidbSqlSqlBuilder *) nil_chk(builder))->sql_)) appendWithNSString:@" WHERE "];
  [builder appendConcatenatedCompilablesWithJavaUtilList:self->criterions_ withNSString:@" AND " withBoolean:forSqlValidation];
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ComYahooSquidbSqlUpdate)
