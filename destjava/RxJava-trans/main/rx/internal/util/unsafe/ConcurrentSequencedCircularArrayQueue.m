//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/kgalligan/devel/xp/sourcejava/RxJava/src/main/java/rx/internal/util/unsafe/ConcurrentSequencedCircularArrayQueue.java
//

#include "IOSClass.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "java/lang/IllegalStateException.h"
#include "rx/internal/util/unsafe/ConcurrentCircularArrayQueue.h"
#include "rx/internal/util/unsafe/ConcurrentSequencedCircularArrayQueue.h"
#include "rx/internal/util/unsafe/UnsafeAccess.h"
#include "sun/misc/Unsafe.h"

inline jlong RxInternalUtilUnsafeConcurrentSequencedCircularArrayQueue_get_ARRAY_BASE();
static jlong RxInternalUtilUnsafeConcurrentSequencedCircularArrayQueue_ARRAY_BASE;
J2OBJC_STATIC_FIELD_PRIMITIVE_FINAL(RxInternalUtilUnsafeConcurrentSequencedCircularArrayQueue, ARRAY_BASE, jlong)

inline jint RxInternalUtilUnsafeConcurrentSequencedCircularArrayQueue_get_ELEMENT_SHIFT();
static jint RxInternalUtilUnsafeConcurrentSequencedCircularArrayQueue_ELEMENT_SHIFT;
J2OBJC_STATIC_FIELD_PRIMITIVE_FINAL(RxInternalUtilUnsafeConcurrentSequencedCircularArrayQueue, ELEMENT_SHIFT, jint)

__attribute__((unused)) static jlong RxInternalUtilUnsafeConcurrentSequencedCircularArrayQueue_calcSequenceOffsetWithLong_(RxInternalUtilUnsafeConcurrentSequencedCircularArrayQueue *self, jlong index);

__attribute__((unused)) static void RxInternalUtilUnsafeConcurrentSequencedCircularArrayQueue_soSequenceWithLongArray_withLong_withLong_(RxInternalUtilUnsafeConcurrentSequencedCircularArrayQueue *self, IOSLongArray *buffer, jlong offset, jlong e);

J2OBJC_INITIALIZED_DEFN(RxInternalUtilUnsafeConcurrentSequencedCircularArrayQueue)

@implementation RxInternalUtilUnsafeConcurrentSequencedCircularArrayQueue

- (instancetype)initWithInt:(jint)capacity {
  RxInternalUtilUnsafeConcurrentSequencedCircularArrayQueue_initWithInt_(self, capacity);
  return self;
}

- (jlong)calcSequenceOffsetWithLong:(jlong)index {
  return RxInternalUtilUnsafeConcurrentSequencedCircularArrayQueue_calcSequenceOffsetWithLong_(self, index);
}

- (void)soSequenceWithLongArray:(IOSLongArray *)buffer
                       withLong:(jlong)offset
                       withLong:(jlong)e {
  RxInternalUtilUnsafeConcurrentSequencedCircularArrayQueue_soSequenceWithLongArray_withLong_withLong_(self, buffer, offset, e);
}

- (jlong)lvSequenceWithLongArray:(IOSLongArray *)buffer
                        withLong:(jlong)offset {
  return [((SunMiscUnsafe *) nil_chk(JreLoadStatic(RxInternalUtilUnsafeUnsafeAccess, UNSAFE))) getLongVolatileWithId:buffer withLong:offset];
}

- (NSUInteger)countByEnumeratingWithState:(NSFastEnumerationState *)state objects:(__unsafe_unretained id *)stackbuf count:(NSUInteger)len {
  return JreDefaultFastEnumeration(self, state, stackbuf, len);
}

+ (void)initialize {
  if (self == [RxInternalUtilUnsafeConcurrentSequencedCircularArrayQueue class]) {
    {
      jint scale_ = [((SunMiscUnsafe *) nil_chk(JreLoadStatic(RxInternalUtilUnsafeUnsafeAccess, UNSAFE))) arrayIndexScaleWithIOSClass:IOSClass_longArray(1)];
      if (8 == scale_) {
        RxInternalUtilUnsafeConcurrentSequencedCircularArrayQueue_ELEMENT_SHIFT = 3 + JreLoadStatic(RxInternalUtilUnsafeConcurrentCircularArrayQueue, SPARSE_SHIFT);
      }
      else {
        @throw new_JavaLangIllegalStateException_initWithNSString_(@"Unexpected long[] element size");
      }
      RxInternalUtilUnsafeConcurrentSequencedCircularArrayQueue_ARRAY_BASE = [JreLoadStatic(RxInternalUtilUnsafeUnsafeAccess, UNSAFE) arrayBaseOffsetWithIOSClass:IOSClass_longArray(1)] + (JreLShift32(RxInternalUtilUnsafeConcurrentCircularArrayQueue_BUFFER_PAD, (RxInternalUtilUnsafeConcurrentSequencedCircularArrayQueue_ELEMENT_SHIFT - JreLoadStatic(RxInternalUtilUnsafeConcurrentCircularArrayQueue, SPARSE_SHIFT))));
    }
    J2OBJC_SET_INITIALIZED(RxInternalUtilUnsafeConcurrentSequencedCircularArrayQueue)
  }
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithInt:", "ConcurrentSequencedCircularArrayQueue", NULL, 0x1, NULL, NULL },
    { "calcSequenceOffsetWithLong:", "calcSequenceOffset", "J", 0x14, NULL, NULL },
    { "soSequenceWithLongArray:withLong:withLong:", "soSequence", "V", 0x14, NULL, NULL },
    { "lvSequenceWithLongArray:withLong:", "lvSequence", "J", 0x14, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "ARRAY_BASE", "ARRAY_BASE", 0x1a, "J", &RxInternalUtilUnsafeConcurrentSequencedCircularArrayQueue_ARRAY_BASE, NULL, .constantValue.asLong = 0 },
    { "ELEMENT_SHIFT", "ELEMENT_SHIFT", 0x1a, "I", &RxInternalUtilUnsafeConcurrentSequencedCircularArrayQueue_ELEMENT_SHIFT, NULL, .constantValue.asLong = 0 },
    { "sequenceBuffer_", NULL, 0x14, "[J", NULL, NULL, .constantValue.asLong = 0 },
  };
  static const char *superclass_type_args[] = {"TE;"};
  static const J2ObjcClassInfo _RxInternalUtilUnsafeConcurrentSequencedCircularArrayQueue = { 2, "ConcurrentSequencedCircularArrayQueue", "rx.internal.util.unsafe", NULL, 0x401, 4, methods, 3, fields, 1, superclass_type_args, 0, NULL, NULL, "<E:Ljava/lang/Object;>Lrx/internal/util/unsafe/ConcurrentCircularArrayQueue<TE;>;" };
  return &_RxInternalUtilUnsafeConcurrentSequencedCircularArrayQueue;
}

@end

void RxInternalUtilUnsafeConcurrentSequencedCircularArrayQueue_initWithInt_(RxInternalUtilUnsafeConcurrentSequencedCircularArrayQueue *self, jint capacity) {
  RxInternalUtilUnsafeConcurrentCircularArrayQueue_initWithInt_(self, capacity);
  self->sequenceBuffer_ = [IOSLongArray newArrayWithLength:(JreLShift32(self->capacity_, JreLoadStatic(RxInternalUtilUnsafeConcurrentCircularArrayQueue, SPARSE_SHIFT))) + RxInternalUtilUnsafeConcurrentCircularArrayQueue_BUFFER_PAD * 2];
  for (jlong i = 0; i < self->capacity_; i++) {
    RxInternalUtilUnsafeConcurrentSequencedCircularArrayQueue_soSequenceWithLongArray_withLong_withLong_(self, self->sequenceBuffer_, RxInternalUtilUnsafeConcurrentSequencedCircularArrayQueue_calcSequenceOffsetWithLong_(self, i), i);
  }
}

jlong RxInternalUtilUnsafeConcurrentSequencedCircularArrayQueue_calcSequenceOffsetWithLong_(RxInternalUtilUnsafeConcurrentSequencedCircularArrayQueue *self, jlong index) {
  return RxInternalUtilUnsafeConcurrentSequencedCircularArrayQueue_ARRAY_BASE + (JreLShift64((index & self->mask_), RxInternalUtilUnsafeConcurrentSequencedCircularArrayQueue_ELEMENT_SHIFT));
}

void RxInternalUtilUnsafeConcurrentSequencedCircularArrayQueue_soSequenceWithLongArray_withLong_withLong_(RxInternalUtilUnsafeConcurrentSequencedCircularArrayQueue *self, IOSLongArray *buffer, jlong offset, jlong e) {
  [((SunMiscUnsafe *) nil_chk(JreLoadStatic(RxInternalUtilUnsafeUnsafeAccess, UNSAFE))) putOrderedLongWithId:buffer withLong:offset withLong:e];
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(RxInternalUtilUnsafeConcurrentSequencedCircularArrayQueue)
